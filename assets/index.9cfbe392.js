import{s as _,M as g,w as f}from"./index.1d800a03.js";import{h as F}from"./index.4677e6e8.js";import{cn as m,n as A,ae as R,p as C,r as D,bt as $,o as y,g as x,V as W,a as v,w as k,co as P,cp as M,y as H}from"./vendor.404b58c2.js";/* empty css                   */const c=[{label:"\u6768\u6708\u971E",value:"\u6768\u6708\u971E"},{label:"\u5468\u5B97\u4E50",value:"\u5468\u5B97\u4E50"},{label:"\u5415\u5E7F\u6CB3",value:"\u5415\u5E7F\u6CB3"},{label:"\u8D75\u6B66\u9633",value:"\u8D75\u6B66\u9633"},{label:"\u7A46\u5B88\u597D",value:"\u7A46\u5B88\u597D"},{label:"\u738B\u5B50\u8C6A",value:"\u738B\u5B50\u8C6A"},{label:"\u9648\u5947",value:"\u9648\u5947"},{label:"\u9A6C\u60F3",value:"\u9A6C\u60F3"},{label:"\u90ED\u6625\u8273",value:"\u90ED\u6625\u8273"},{label:"\u4F55\u8FD0\u5F3A",value:"\u4F55\u8FD0\u5F3A"},{label:"\u738B\u82E5\u5B87",value:"\u738B\u82E5\u5B87"}],p=[{label:"\u6C34\u6CE5",value:"\u6C34\u6CE5"},{label:"\u77FF\u7C89",value:"\u77FF\u7C89"},{label:"\u77FF\u7C89\u8FD0\u8D39",value:"\u77FF\u7C89\u8FD0\u8D39"},{label:"\u7C89\u7164\u7070",value:"\u7C89\u7164\u7070"},{label:"\u5916\u52A0\u5242",value:"\u5916\u52A0\u5242"},{label:"\u9EC4\u6C99",value:"\u9EC4\u6C99"},{label:"\u673A\u5236\u7802",value:"\u673A\u5236\u7802"},{label:"\u74DC\u5B50\u7247",value:"\u74DC\u5B50\u7247"},{label:"\u77F3\u5B50",value:"\u77F3\u5B50"}],N={owner:[{required:!0,message:"\u8BF7\u9009\u62E9\u53D1\u8D27\u5355\u4F4D\uFF01"}],goods:[{required:!0,message:"\u8BF7\u9009\u62E9\u5546\u54C1\u540D\u79F0\uFF01"}],unitPrice:[{required:!0,message:"\u8BF7\u8F93\u5165\u5546\u54C1\u4EF7\u683C\uFF01"},{min:0,message:"\u592A\u4F4E\u4E86"}],totalPrice:[{required:!0,message:"\u8BF7\u8F93\u5165\u603B\u4EF7\uFF01"},{min:0,message:"\u592A\u4F4E\u4E86"}]},S={border:!0,stripe:!0,resizable:!0,showOverflow:"tooltip",showHeaderOverflow:"tooltip",highlightHoverRow:!0,loading:!1,rowId:"oddNumber",keepSource:!0,height:800,id:"wh_table",columns:[{type:"checkbox",title:"ID",width:60},{field:"oddNumber",title:"\u78C5\u5355\u53F7",sortable:!0,editRender:{name:"input",attrs:{placeholder:"\u8BF7\u8F93\u5165\u78C5\u5355\u53F7\uFF01"}}},{field:"goods",title:"\u5546\u54C1\u540D\u79F0",sortable:!0,editRender:{name:"$select",options:p},filters:p,filterMultiple:!0},{field:"owner",title:"\u53D1\u8D27\u5355\u4F4D",sortable:!0,editRender:{name:"$select",options:c},filters:c,filterMultiple:!0},{field:"storingLocation",title:"\u4ED3\u53F7",sortable:!0,editRender:{name:"input",attrs:{placeholder:"\u8BF7\u8F93\u5165\u4ED3\u53F7\uFF01"}},filters:[{label:"\u672A\u5165\u5E93",value:-1},{label:"\u7802\u77F3\u6599",value:null},{label:1,value:1},{label:2,value:2},{label:3,value:3},{label:4,value:4},{label:5,value:5},{label:0,value:0}]},{field:"realWeight",title:"\u5B9E\u91CD",sortable:!0,editRender:{name:"$input",props:{type:"float",digits:2,placeholder:"\u8BF7\u8F93\u5165\u5B9E\u9645\u91CD\u91CF\uFF01"}}},{field:"unitPrice",title:"\u5355\u4EF7",sortable:!0,editRender:{name:"$input",props:{type:"float",digits:2,placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u4EF7\u683C\uFF01"}}},{field:"totalPrice",title:"\u603B\u4EF7",sortable:!0,editRender:{name:"$input",props:{type:"float",digits:2,placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u4EF7\u683C\uFF01"}}},{field:"grossWeightTime",title:"\u6BDB\u91CD\u65F6\u95F4",sortable:!0,formatter({cellValue:o}){return o?m(o).format("YYYY/MM/DD HH:mm a"):""},editRender:{name:"input"}},{field:"tareTime",title:"\u76AE\u91CD\u65F6\u95F4",formatter({cellValue:o}){return o?m(o).format("YYYY/MM/DD HH:mm a"):""},editRender:{name:"input"}},{field:"carNumber",title:"\u6C7D\u8F66\u53F7",editRender:{name:"input"}},{field:"grossweight",title:"\u6BDB\u91CD",editRender:{name:"input"}},{field:"tare",title:"\u76AE\u91CD",editRender:{name:"input"}},{field:"netWeight",title:"\u51C0\u91CD",editRender:{name:"input"}}],customConfig:{storage:!0},printConfig:{columns:[{field:"oddNumber"},{field:"goods"},{field:"owner"},{field:"storingLocation"},{field:"realWeight"},{field:"unitPrice"},{field:"totalPrice"},{field:"grossWeightTime"}]},sortConfig:{trigger:"cell"},pagerConfig:{pageSize:10,pageSizes:[5,10,15,20,50,100,500,1e3]},formConfig:{titleWidth:100,titleAlign:"right",data:{goods:"",owner:""},items:[{field:"goods",title:"\u5546\u54C1\u540D\u79F0",span:8,itemRender:{name:"$select",options:p}},{field:"owner",title:"\u53D1\u8D27\u5355\u4F4D",span:8,itemRender:{name:"$select",options:c}},{span:24,align:"center",itemRender:{name:"$buttons",children:[{props:{type:"submit",content:"\u67E5\u8BE2",status:"primary"}},{props:{type:"reset",content:"\u91CD\u7F6E"}}]}}]},toolbarConfig:{buttons:[{code:"delete_wh",name:"\u5220\u9664",icon:"fa fa-trash-o"},{code:"save_wh",name:"\u4FDD\u5B58",icon:"fa fa-save",status:"success"}],import:!0,export:!0,zoom:!0,custom:!0},checkboxConfig:{labelField:"ID",reserve:!0,highlight:!0,range:!0},editRules:N,editConfig:{trigger:"dblclick",mode:"row",showStatus:!0}},q=A({setup(o){const n=R(S),s=C(),r=C(!1),b={formSubmit(e){r.value=!0,F.get("/api/warehousings").then(a=>{_(a.message),n.data=a.data.data,n.pagerConfig.total=a.data.total,r.value=!1})},paste(e){E(e)},toolbarButtonClick({code:e}){switch(e){case"save_wh":h();break;case"delete_wh":B();break}}},h=async()=>{r.value=!0;let e=s.value.getCheckboxRecords();if(e.length>0){let a=0,t=0,l=0;try{for(const u of e){if(u._id){l+=1;continue}(await F.post("/api/warehousings",{data:u})).statusCode===200?a+=1:t+=1}}catch{t+=1}s.value.reloadData(),g(`\u4FDD\u5B58\u6210\u529F\uFF1A${a}, \u4FDD\u5B58\u5931\u8D25\uFF1A${t}\uFF0C\u5DF2\u4FDD\u5B58\uFF1A${l}`)}else f("\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u9879");r.value=!1},B=async()=>{r.value=!0;let e=s.value.getCheckboxRecords();if(e.length>0){let a=0,t=0,l=0;try{for(const u of e){if(!u._id){l+=1;continue}(await F.request("delete",`/api/warehousings/${u._id}`)).statusCode===200?a+=1:t+=1}}catch{t+=1}g(`\u5220\u9664\u6210\u529F\uFF1A${a}, \u5220\u9664\u5931\u8D25\uFF1A${t}, \u672A\u4FDD\u5B58\uFF1A${l}`),s.value.reloadData()}else f("\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u9879");r.value=!1},E=async e=>{e.$event.preventDefault(),e.$event.stopPropagation();const a=["oddNumber","carNumber","goods","grossWeight","tare","netWeight","owner","grossWeightTime","tareTime","storingLocation","realWeight","unitPrice","totalPrice"];let t=e.$event.clipboardData.getData("text");t=t.split(`\r
`);let l=t.map(u=>u.split("	")).filter(u=>u[0]!=="");l=l.map(u=>{let i={};return u.map((d,w)=>i[a[w]]=d),i}),n.data=l};return(e,a)=>{const t=D("vxe-grid"),l=D("el-card"),u=$("loading");return y(),x("div",null,[W(v(l,null,{default:k(()=>[v(t,P({ref:(i,d)=>{d.whGrid=i,s.value=i}},H(n),M(b)),null,16)]),_:1},512),[[u,r.value]])])}}});export{q as default};
